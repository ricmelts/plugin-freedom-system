---
plugin: RedShiftDistortion
stage: 3
phase: 3.1
status: in_progress
last_updated: 2026-02-12
complexity_score: 4.6
workflow: GUI Implementation
next_action: complete_remaining_ui_elements
---

# RedShiftDistortion - Continue Here

**Current Status:** Stage 3 Phase 3.1 (GUI Layout - Partial)

## Completed So Far

### âœ… Stage 0 (Research) - COMPLETE
- Architecture finalized: Granular doppler shift with cumulative feedback loop
- Plan created: 3-phase DSP implementation strategy
- Parameter spec: 13 APVTS parameters defined

### âœ… Stage 1 (Foundation + Shell) - COMPLETE
- Build system operational (CMake + JUCE 8)
- 13 APVTS parameters implemented and bound
- VST3 + AU + Standalone formats configured

### âœ… Stage 2 (DSP Implementation) - COMPLETE
- **Phase 2.1:** Stereo width + basic tape delay âœ…
- **Phase 2.2:** Feedback loop with saturation + dual-band filters âœ…
- **Phase 2.3:** Granular doppler shift (128-frame grain synthesis) âœ…
- All DSP processing verified and tested
- Real-time safe (no allocations in processBlock)
- Latency reporting implemented

### âœ… Stage 3 (GUI Implementation) - PARTIAL
**Completed UI Elements:**
- âœ… Window size: 950x700px
- âœ… Diamond plate background texture
- âœ… Red corner screws (4 corners, 38px)
- âœ… Title: "RED SHIFT" (needs font update to Jacquard 12)
- âœ… Subtitle: "digital delay" (needs styling update)
- âœ… **Main doppler knob (center):**
  - 168px HISE filmstrip knob (black gear, 128 frames)
  - Position: x:391, y:266
  - Range: -50% to +50%
  - Parameter binding: âœ… Working
  - Label: "doppler effect delay"
  - Value display: Live percentage
- âœ… **6 Surrounding knobs (130px each):**
  - All using HISE medium filmstrip (100px frames, scaled to 130px)
  - **Stereo Width** (top-left): -100% to +100% âœ…
  - **Feedback** (top-center): 0% to 95% âœ…
  - **Master Output** (top-right): -60dB to +12dB âœ…
  - **Lo-Cut Filter** (bottom-left): 20Hz-20kHz (logarithmic) âœ…
  - **Saturation** (bottom-center): -12dB to +24dB âœ…
  - **Hi-Cut Filter** (bottom-right): 20Hz-20kHz (logarithmic) âœ…
  - All parameter bindings working âœ…
  - Value labels with smart Hz/kHz conversion âœ…

---

## Remaining UI Tasks (Stage 3 Phase 3.1-3.3)

### ðŸ”² Phase 3.1: Visual Polish (Remaining)

**1. Add Red Glow Layers Behind All Knobs**
- Main doppler knob: Two glow layers (outer: 315px, inner: 231px)
- 6 sub-knobs: Two glow layers each (outer: 100px, inner: 75px)
- Glow colors: `rgba(242, 26, 29, 0.8)` and `rgba(189, 0, 0, 0.6)`
- Blur amounts: 42px (outer), 31px (inner) for main; 15px/10px for sub-knobs
- Implementation: Add to `paint()` method before drawing knobs

**2. Update Title Font**
- Change from "sans-serif" to **"Jacquard 12"** web font
- Import: `@import url('https://fonts.googleapis.com/css2?family=Jacquard+12&display=swap');`
- Keep: 60px size, black color, red glow effect

**3. Update Subtitle Styling**
- Font: **"Handjet"** (already imported)
- Text: White color (`#ffffff`)
- Background: Black rounded rectangle behind text
- Keep: 30px size, position at y:660

**4. Update All Knob Labels**
- Font: **"Handjet"**
- Text: White color
- Background: Black rounded rectangles
- Glow effect: Red text-shadow (`0px -7px 50px #bd0000`)

### ðŸ”² Phase 3.2: VU Meters (Right Side)

**Dual Stereo VU Meters**
- Position: x:820, y:175
- Left meter: 40px wide Ã— 350px tall
- Right meter: 40px wide Ã— 350px tall
- Gap: 10px between meters
- Style: Solid red LED bar (`#F21A1D`)
- Background: Dark brown (`#1a0a00`)
- Border: 2px black
- Labels: "L" and "R" above meters
- **Implementation:** Create custom component with real-time audio level tracking

### ðŸ”² Phase 3.3: Bypass Buttons + Advanced Settings

**4 Bypass Buttons (Left Side, Vertical Stack)**
- Position: x:25, vertical spacing from y:230
- Size: 29px diameter each
- Style: Circular LED buttons with gradient
- Active state: Red glow (`#F21A1D`)
- Labels (right side):
  1. "Doppler" (y:230) â†’ bypassDoppler
  2. "Saturation" (y:285) â†’ bypassSaturation
  3. "Filters" (y:340) â†’ bypassFilters (note: maps to both filter bypasses)
  4. "Feedback" (y:395) â†’ bypassFeedback

**Advanced Settings (Bottom-Right)**
- **Grain Size Slider:**
  - Position: x:815, y:630
  - Size: 90px Ã— 23px
  - Range: 25ms - 200ms
  - Default: 50ms
  - Parameter: grainSize
- **Grain Overlap Dropdown:**
  - Position: x:815, y:665
  - Size: 90px Ã— 26px
  - Options: "2x", "4x"
  - Default: "4x" (index 1)
  - Parameter: grainOverlap

---

## Implementation Plan

### Step 1: Visual Polish (Est: 30 min)
```bash
# Add to PluginEditor.cpp paint() method:
- Red glow layers for all knobs (draw before knobs)
- Update title to Jacquard 12 font
- Add black background rectangles for labels
- Update all labels to white Handjet text
```

### Step 2: VU Meters (Est: 45 min)
```bash
# Create custom VU meter component:
- Add to PluginEditor.h: VUMeter class
- Implement real-time audio level tracking
- Smooth peak/RMS calculation
- Vertical LED bar rendering
```

### Step 3: Bypass Buttons (Est: 20 min)
```bash
# Add 4 circular toggle buttons:
- Custom button styling (gradient + LED glow)
- Parameter attachments for bypass controls
```

### Step 4: Advanced Settings (Est: 15 min)
```bash
# Add horizontal slider + dropdown:
- Native JUCE Slider (horizontal)
- ComboBox for grain overlap
- Parameter attachments
```

---

## Next Steps After UI Complete

### Testing & Validation

**1. Visual Testing**
- [ ] All 7 knobs render with filmstrips
- [ ] Red glows visible behind knobs
- [ ] Fonts correct (Jacquard title, Handjet labels)
- [ ] VU meters show real-time levels
- [ ] Bypass buttons toggle correctly
- [ ] Advanced settings functional

**2. Parameter Testing**
- [ ] Load in DAW (Ableton/Logic/Reaper)
- [ ] Verify all 13 parameters automatable
- [ ] Check parameter persistence (save/load presets)
- [ ] Test MIDI CC mapping
- [ ] Verify parameter ranges and defaults

**3. DSP Testing**
- [ ] **Doppler Shift:** Audible pitch shifting (-50% to +50%)
- [ ] **Stereo Width:** Spatial positioning works
- [ ] **Feedback:** Creates multiple repeats (0-95%)
- [ ] **Saturation:** Cumulative distortion in feedback loop
- [ ] **Filters:** Lo-cut and hi-cut sculpt frequency response
- [ ] **Grain Settings:** Size and overlap affect CPU and quality
- [ ] **Bypass Controls:** All bypasses work correctly

**4. Performance Testing**
- [ ] CPU usage acceptable (target: <40% single core at 48kHz)
- [ ] No audio dropouts or glitches
- [ ] Stable at high feedback + doppler settings
- [ ] Grain size affects latency correctly
- [ ] VU meters don't impact performance

**5. Stability Testing**
- [ ] No crashes when loading/unloading
- [ ] No memory leaks (long sessions)
- [ ] Automation doesn't cause issues
- [ ] Preset switching stable
- [ ] DAW project save/load works

---

## Known Issues

None yet - UI implementation in progress.

---

## Build Commands

**Build Standalone:**
```bash
cmake --build build --target RedShiftDistortion_Standalone
```

**Build + Install All Formats:**
```bash
./scripts/build-and-install.sh RedShiftDistortion
```

**Launch Standalone:**
```bash
open build/plugins/RedShiftDistortion/RedShiftDistortion_artefacts/Release/Standalone/RedShiftDistortion.app
```

---

## Files Modified (Stage 3 So Far)

| File | Changes |
|------|---------|
| `Source/PluginEditor.h` | Added FilmstripLookAndFeel + MediumFilmstripLookAndFeel classes, 7 knobs + labels |
| `Source/PluginEditor.cpp` | Implemented filmstrip rendering, 7 knobs, background painting, parameter bindings |
| `CMakeLists.txt` | Added UI assets (diamond plate, screws, 2 filmstrip knobs) |
| `.ideas/mockups/assets/` | Added hise_Knob_medium.png from Analog GUI Kit |

---

## Reference Files

- **Creative Brief:** `.ideas/creative-brief.md`
- **Architecture:** `.ideas/architecture.md`
- **Parameter Spec:** `.ideas/parameter-spec.md`
- **Implementation Plan:** `.ideas/plan.md`
- **UI Mockup:** `.ideas/mockups/v10-ui.yaml` (design specification)
- **UI Test HTML:** `.ideas/mockups/v10-ui-test.html` (interactive preview)
- **Phase 2.3 DSP Summary:** `.ideas/phase-2.3-summary.md` (DSP completion report)

---

## Success Criteria for Stage 3 Completion

âœ… All UI elements from v10 mockup implemented
âœ… All 13 parameters connected and functional
âœ… Visual design matches mockup (fonts, colors, glows)
âœ… VU meters show real-time audio levels
âœ… Plugin loads in DAW without issues
âœ… No visual glitches or rendering problems
âœ… Responsive UI (smooth knob dragging, no lag)

**Once UI complete â†’ Proceed to full plugin testing and validation.**

---

**Ready to continue with remaining UI elements!**
